<!DOCTYPE html>
<html>
<head>
  <title>RaspiKids</title>
</head>
<body>
<div>
	<svg id="graph">
	</svg>
</div>
<script>
var d3 = require('d3');

console.log('aaa');

var vis = d3.select("#graph");

var w = 900, h = 400;
vis.attr("width", w)
   .attr("height", h);

var data = require('../wf/lightBlink.json');

var nodes = [];

var links = [];

//make array of WF and links
for(var k in data){
	var o = data[k];
	o.id = k;
	nodes.push(o);
	
	if(o.data && o.data.out){
		for(var i in o.data.out){
			var outObject = o.data.out[i];
			var link = {
					source: o,
					target: data[outObject.target]
				};
			links.push(link);
		}
	}
}
             
vis.selectAll("circle .nodes")
	.data(nodes)
	.enter()
	.append("circle")
	.attr("class", "nodes")
	.attr("cx", function(d) { return d.meta_data.x; })
	.attr("cy", function(d) { return d.meta_data.y; })
	.attr("r", "10px")
	.attr("fill", "black");
	
vis.selectAll(".line")
	.data(links)
	.enter()
	.append("line")
	.attr("x1", function(d) { 
		return d.source.meta_data.x 
	})
	.attr("y1", function(d) { 
		return d.source.meta_data.y 
	})
	.attr("x2", function(d) { 
		return d.target.meta_data.x 
	})
	.attr("y2", function(d) { 
		return d.target.meta_data.y 
	})
	.style("stroke", "rgb(6,120,155)");

</script>  
</body>
</html>